<form [formGroup]="searchForm" class="cve-search">
    <mat-form-field>
        <mat-select #type formControlName="type" placeholder="Type">
            <mat-option *ngFor="let type of types" [value]="type.value">{{type.name}}</mat-option>
        </mat-select>
    </mat-form-field>

   <div [ngSwitch]="type.value">
       <ng-container *ngSwitchCase="'id'">
           <mat-form-field>
               <input matInput type="text" placeholder="CVE-YYYY-{number}" formControlName="cveId" pattern="CVE-\d{4}-\d{4,}" (keyup.enter)="fetchCVE()"/>
            </mat-form-field>
        </ng-container>
        <ng-container *ngSwitchCase="'product'">
            <mat-form-field>
                <input matInput type="text" placeholder="Vendor" formControlName="vendor" [matAutocomplete]="autoVendor"/>
                <mat-autocomplete #autoVendor="matAutocomplete">
                    <mat-option *ngFor="let vendor of filterdVendors | async" [value]="vendor">{{vendor}}</mat-option>
                </mat-autocomplete>
            </mat-form-field>
            <mat-form-field>
                <input matInput type="text" placeholder="Product" formControlName="product" [matAutocomplete]="autoProduct"/>
                <mat-autocomplete #autoProduct="matAutocomplete">
                    <mat-option *ngFor="let product of filterdProducts | async" [value]="product">{{product}}</mat-option>
                </mat-autocomplete>
            </mat-form-field>
       </ng-container>
    </div>
</form>  

<div class="cve-list">
    <mat-spinner *ngIf="loadingCVEList"></mat-spinner>
    <table mat-table [dataSource]="cveList" class="mat-elevation-z8 table" *ngIf="cveList.length">
        <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef> ID </th>
            <td mat-cell *matCellDef="let element"> 
                <a [routerLink]="'cve/' + element.id">{{element.id}}</a>
            </td>
        </ng-container>
    
        <ng-container matColumnDef="cvss">
            <th mat-header-cell *matHeaderCellDef> CVSS </th>
            <td mat-cell *matCellDef="let element"> {{element.cvss}} </td>
        </ng-container>

        <ng-container matColumnDef="summary">
            <th mat-header-cell *matHeaderCellDef> Summary </th>
            <td mat-cell *matCellDef="let element"> {{element.summary}} </td>
        </ng-container>
        
        <tr mat-header-row *matHeaderRowDef="cveListDisplayColumns"></tr>
        <tr mat-row *matRowDef="let myRowData; columns: cveListDisplayColumns"></tr>
    </table>
</div>